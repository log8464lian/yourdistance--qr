<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <title>温柔提醒</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/>
  <link rel="manifest" href="manifest.json">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:-apple-system,"Helvetica Neue",Arial;background:#fff9f9;height:100vh;overflow:hidden}
    #okBtn{background:#ff006e;color:#fff;border:none;padding:14px 28px;border-radius:30px;font-size:18px;letter-spacing:1px}
    .modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.15);padding:24px 32px;max-width:280px;text-align:center;z-index:9999}
    .modal h3{margin-bottom:12px;font-size:20px}
    .pop{position:absolute;padding:14px 18px;border-radius:12px;font-size:15px;color:#fff;box-shadow:0 4px 12px rgba(0,0,0,.25);
          text-shadow:0 0 2px #000;animation:fadeIn .6s}
    @keyframes fadeIn{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}
  </style>
</head>
<body>

<!-- 初始确认框 -->
<div id="confirm" class="modal">
  <h3>温馨提示</h3>
  <p style="margin:12px 0;color:#555">准备接收今日份温柔～</p>
  <button id="okBtn" disabled>确定</button>
</div>

<script>
/* ===== 1. 先声明空数组 ===== */
let colors = [];
let sentences = [];

/* ===== 2. 拉取 data.json ===== */
fetch('data.json')
  .then(r => r.json())
  .then(d => {
    colors  = d.colors;
    sentences = d.sentences;
    /* 数据到位才允许点“确定” */
    document.getElementById('okBtn').disabled = false;
  })
  .catch(err => {
    alert('加载配置失败，请检查网络~');
  });

/* ===== 3. 按钮先禁用 ===== */
document.getElementById('okBtn').disabled = true;

/* ===== 4. 逻辑部分 ===== */
const okBtn = document.getElementById('okBtn');
const confirmBox = document.getElementById('confirm');

okBtn.onclick = () => {
  confirmBox.style.display = 'none';
  startRain();
};

function rand(n) {
  return Math.floor(Math.random() * n);
}

function startRain() {
  const tick = () => {
    const p = document.createElement('div');
    p.className = 'pop';
    p.style.background = colors[rand(colors.length)];
    p.style.left = rand(window.innerWidth - 220) + 'px';
    p.style.top  = rand(window.innerHeight - 80) + 'px';
    p.textContent = sentences[rand(sentences.length)];
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 4000);
  };
  tick();               // 先出第一个
  setInterval(tick, 1100); // 以后每 1.1 秒一个
}
</script>
</body>
</html>