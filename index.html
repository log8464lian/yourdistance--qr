<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <title>å±±æµ·å¯å¹³ï¼Œä¸è´Ÿç›¸é‡</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/>
  <link rel="manifest" href="manifest.json">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:-apple-system,"Helvetica Neue",Arial;background:#fff9f9;height:100vh;overflow:hidden}
    #okBtn{background:#ff006e;color:#fff;border:none;padding:14px 28px;border-radius:30px;font-size:18px;letter-spacing:1px}
    .modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.15);padding:24px 32px;max-width:280px;text-align:center;z-index:9999}
    .modal h3{margin-bottom:12px;font-size:20px}
    .pop{position:absolute;padding:14px 18px;border-radius:12px;font-size:15px;color:#fff;box-shadow:0 4px 12px rgba(0,0,0,.25);text-shadow:0 0 2px #000;animation:fadeIn .6s}
    @keyframes fadeIn{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}

    /* å³ä¸Šè§’éŸ³ä¹å¼€å…³ */
    #musicCtrl{
      position:fixed;
      top:12px;
      right:12px;
      width:44px;
      height:44px;
      border:none;
      border-radius:50%;
      background:rgba(255,255,255,.9);
      box-shadow:0 2px 8px rgba(0,0,0,.2);
      font-size:22px;
      line-height:44px;
      text-align:center;
      cursor:pointer;
      z-index:9999;
    }
  </style>
</head>

<body>
  <!-- éŸ³ä¹ -->
  <button id="musicCtrl" title="éŸ³ä¹å¼€å…³">ğŸµ</button>
  <audio id="bgMusic" src="bgm.mp3" loop></audio>

  <!-- åˆå§‹ç¡®è®¤æ¡† -->
  <div id="confirm" class="modal">
    <h3>æ¸©é¦¨æç¤º</h3>
    <p style="margin:12px 0;color:#555">å‡†å¤‡æ¥æ”¶ä»Šæ—¥ä»½æ¸©æŸ”ï½</p>
    <button id="okBtn" disabled>ç¡®å®š</button>
  </div>

  <script>
  /* ========== éŸ³ä¹æ§åˆ¶ ========== */
  const bgMusic = document.getElementById('bgMusic');
  const musicBtn = document.getElementById('musicCtrl');
  musicBtn.onclick = () => {
    if (bgMusic.paused) {
      bgMusic.play();
      musicBtn.textContent = 'ğŸµ';
    } else {
      bgMusic.pause();
      musicBtn.textContent = 'ğŸ”‡';
    }
  };
  // æµè§ˆå™¨é¦–æ¬¡äº¤äº’åè‡ªåŠ¨æ’­æ”¾
  document.body.addEventListener('touchstart', () => {
    if (bgMusic.paused) bgMusic.play();
  }, { once: true });

  /* ========== å¼¹çª—é€»è¾‘ ========== */
  let colors = [], sentences = [];
  fetch('data.json')
    .then(r => r.json())
    .then(d => {
      colors = d.colors;
      sentences = d.sentences;
      document.getElementById('okBtn').disabled = false;
    })
    .catch(err => {
      alert('åŠ è½½é…ç½®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ~');
    });

  document.getElementById('okBtn').disabled = true;
  const okBtn = document.getElementById('okBtn');
  const confirmBox = document.getElementById('confirm');

  okBtn.onclick = () => {
    confirmBox.style.display = 'none';
    startRain();
  };

  function rand(n) {
    return Math.floor(Math.random() * n);
  }

  function startRain() {
    const tick = () => {
      const p = document.createElement('div');
      p.className = 'pop';
      p.style.background = colors[rand(colors.length)];
      p.style.left = rand(window.innerWidth - 220) + 'px';
      p.style.top = rand(window.innerHeight - 80) + 'px';
      p.textContent = sentences[rand(sentences.length)];
      document.body.appendChild(p);
    };
    tick();
    setInterval(tick, 1100);
  }
  </script>
</body>
</html>